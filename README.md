# Middle Frontend TZ

Трёхстраничный сайт с интеграцией Битрикс24 API и локальной базой данных SQLite.

## Технологии

- **Next.js 15** + TypeScript
- **Tailwind CSS** для стилизации
- **Swiper** для слайдеров
- **Better-sqlite3** для локальной базы данных
- **bcryptjs** для хеширования паролей
- **MUI** (опционально)

## Установка и запуск

1. Установите зависимости:
```bash
npm install
```

2. Создайте файл `.env.local` и добавьте ваш URL вебхука Битрикс24:
```
BITRIX_WEBHOOK_URL=https://your-domain.bitrix24.ru/rest/1/webhook-code/
```

3. Запустите проект в режиме разработки:
```bash
npm run dev
```

4. Откройте [http://localhost:3000](http://localhost:3000) в браузере.

## Структура проекта

### Страницы
- `/auth` - Регистрация/авторизация
- `/dashboard` - Главная страница с дашбордом
- `/profile` - Профиль пользователя
- `/orders` - Страница заказов
- `/payments` - Страница платежей с интеграцией Битрикс24

### API Routes
- `/api/auth/register` - Регистрация пользователя
- `/api/auth/login` - Авторизация пользователя
- `/api/user/[id]` - Получение и обновление данных пользователя
- `/api/bitrix/deals` - Получение сделок из Битрикс24
- `/api/bitrix/deals/[id]/pay` - Обработка платежа (перевод сделки в стадию "В работе")

### Компоненты
- `Header` - Адаптивная навигация
- `OrdersSlider` - Слайдер заказов на Swiper
- `ProfileBlock` - Блок профиля на дашборде
- `BroadcastBlock` - Блок трансляции
- `PaymentsBlock` - Блок платежей на дашборде

## Функциональность

### Регистрация/Авторизация
- Валидация формы с отображением ошибок
- Хеширование паролей с bcryptjs
- Проверка пароля: минимум 6 символов, заглавная буква и цифра
- Сохранение пользователей в SQLite
- Создание контактов в Битрикс24 (при регистрации)

### Дашборд
- Блок "Заказы" - слайдер с карточками документов
- Блок "Профиль" - данные пользователя с возможностью редактирования
- Блок "Трансляция" - имитация live-трансляции
- Блок "Платежи" - таблица с данными из Битрикс24

### Платежи
- Интеграция с Битрикс24 CRM
- Отображение сделок в виде таблицы платежей
- Кнопка "Оплатить" переводит сделку в стадию "В работе"
- Статус "Оплачено" = сделка на стадии "В работе" или выше

### Адаптивность
- Мобильная версия навигации
- Адаптивные сетки и компоненты
- Responsive дизайн для всех устройств

## Настройка Битрикс24

1. Зарегистрируйтесь в Битрикс24
2. Перейдите: Приложения → Разработчикам → Другое → Входящий вебхук
3. Включите демо-тариф
4. Скопируйте URL вебхука и добавьте в `.env.local`

## База данных

Проект использует SQLite с Better-sqlite3. База данных создается автоматически при первом запуске.

### Таблица users
- `id` - PRIMARY KEY
- `login` - уникальный логин
- `email` - уникальный email
- `password` - хешированный пароль
- `name` - имя пользователя
- `phone` - телефон
- `address` - адрес
- `created_at` - дата создания

## Сборка для продакшена

```bash
npm run build
npm start
```